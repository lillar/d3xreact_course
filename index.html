<!DOCTYPE html>
<html lang="en"></html>
    <head>
        <meta charset="UTF-8">
        <title>Lilla learns D3</title>
        <script src="https://d3js.org/d3.v7.min.js"></script>
        <link rel="stylesheet" href="styles.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500&family=Montserrat:wght@600;700&display=swap" rel="stylesheet">
        <style>
        </style>
    </head>
    <body>
        <header>
            <nav>
                <ul>
                    <li><a href="#home">Home</a></li>
                    <li><a href="#about">About me</a></li>
                    <li><a href="#contact">Contact</a></li>
                    <li><a href="#projects">Projects</a></li>
                </ul>
            </nav>
        </header>
        <main >
            <div id="home">
                <h1>Hello you</h1>
                <p>    
                    Thank you for being a witness to my journey of conquering D3. Nice to see you here.
                </p>
            </div>
            <div id="about">
                <div class="about-container">
                    <div class="about-img" id="eye-container">
                        <div class="zigzag-decor">
                            <div class="zigzag-small"></div>
                            <div class="zigzag-small"></div>
                        </div>
                        <img src="me-2.png" alt="A picture of me">
                    </div>
                    <div class="about-text">
                        <div class="about-intro">
                            <h2>About Me</h2>
                            <div class="zigzag"></div>
                            <p>
                            Growth happens at the edge of discomfort (I hope).
                            That’s why I started this journey into D3 — again —. Not because it’s easy, 
                            but because it is the next step when I think about data, design and storytelling.
                            </p>

                            <p>
                            My background is rooted in analytics, where structure and clarity matter. 
                            But I’m equally drawn to creativity — to the idea that numbers can feel 
                            art when presented thoughtfully.
                            </p>

                            <p>
                            This website is my digital notebook. A place to experiment, 
                            fail, iterate and improve — one visualization at a time.
                            </p>
                        </div>  
                    </div>
                </div>
            </div>
            <div id="contact">
                <h2>Contact</h2>
                <div class="zigzag"></div>
                <p>Let's connect on Linkedin or check out my portfolio on Tableau Public!</p>
                <div class="social-links">
                    <a href="https://www.linkedin.com/in/lillarasztik/" target="_blank" rel="noopener noreferrer">
                        <i class="fa-brands fa-linkedin-in"></i>
                    </a>

                    <a href="https://public.tableau.com/app/profile/lilla.rasztik/vizzes#!/" target="_blank" rel="noopener noreferrer">
                        <i class="fa-solid fa-chart-line"></i>
                    </a>
                </div>
            </div>
            <div id="projects"> 
                <h2>Projects</h2>
                <div class="zigzag"></div>
                <p>    
                    See what I'm cooking in D3!
                </p>
                <div class="scrolly-container">
                    <article class="story-column">
                        <section class="step" data-step="2020">
                            <h3>2020: The Beginning</h3>
                            <p>In May 2020, I started tracking my activity. It was a modest start, capturing just the final months of the year.</p>
                        </section>
                        <section class="step" data-step="2021">
                            <h3>2021: Finding a Rhythm</h3>
                            <p>As 2021 progressed, the data began to show more consistency in my daily movements.</p>
                        </section>
                        <section class="step" data-step="2022">
                            <h3>2022: Building Momentum</h3>
                            <p>By 2022, the peaks grew taller as activity became a core part of my routine.</p>
                        </section>
                        <section class="step" data-step="2023">
                            <h3>2023: Scaling Up</h3>
                            <p>2023 saw significant growth in total active minutes compared to previous years.</p>
                        </section>
                        <section class="step" data-step="2024">
                            <h3>2024: The Peak</h3>
                            <p>Reaching new heights in activity levels throughout the year.</p>
                        </section>
                        <section class="step" data-step="yoy">
                            <h3>Year-over-Year Growth</h3>
                            <p>Look at the growth! From 1,461 minutes in 2020 to over 20,000 in 2025.</p>
                        </section>
                        <section class="step" data-step="cumsum">
                            <h3>The Big Picture: Cumulative Sum</h3>
                            <p>Transforming the data into a cumulative view shows the total journey over the years.</p>
                        </section>
                    </article>

                    <div class="sticky-viz">
                        <div id="viz-canvas"></div>
                    </div>
                </div>
            </div>
        </main>
        <footer>
        </footer>
 <script>
    //--------------------- Create the following eyes on the page ---------------------//
    const width = 200;
    const height = 200;

    const svg = d3.select("#eye-container")
        .append("svg")
        .attr("width", width)
        .attr("height", height)
        .style("position", "absolute")
        .style("top", "0")
        .style("left", "0");

    const eyeData = [
        { cx: 93, cy: 103 }, // Left Eye
        { cx: 124, cy: 103 } // Right Eye
    ];

    // Create a group for each eye to move layers together
    const eyeGroups = svg.selectAll(".eye-group")
        .data(eyeData)
        .enter()
        .append("g")
        .attr("class", "eye-group")
        // Initial position
        .attr("transform", d => `translate(${d.cx}, ${d.cy})`);

    // LAYER 1: The Brown Iris (Oval)
    eyeGroups.append("ellipse")
        .attr("rx", 5) // Horizontal radius
        .attr("ry", 7) // Vertical radius makes it oval
        .attr("fill", "#634e34");

    // LAYER 2: The Dark Pupil (Smaller Oval)
    eyeGroups.append("ellipse")
        .attr("rx", 3)
        .attr("ry", 4)
        .attr("fill", "#1a130c");

    // LAYER 3: The Cute Shine (Small off-white circle)
    eyeGroups.append("circle")
        .attr("cx", 1) // Positioned slightly top-left of center
        .attr("cy", -4)
        .attr("r", 1.5)
        .attr("fill", "#fefaf0");

    d3.select("body").on("mousemove", (event) => {
        const [mouseX, mouseY] = d3.pointer(event);
        const boundingRect = document.querySelector('img').getBoundingClientRect();

        eyeGroups.each(function(d) {
            const group = d3.select(this);
            
            // Calculate absolute center of this eye on the page
            const eyeX = boundingRect.left + d.cx;
            const eyeY = boundingRect.top + d.cy;

            const angle = Math.atan2(mouseY - eyeY, mouseX - eyeX);
            
            // Constrain movement so the oval stays within the eye socket
            const distance = 1; 
            const moveX = Math.cos(angle) * distance;
            const moveY = Math.sin(angle) * distance;

            // Use translate to move the entire group (Iris + Pupil + Shine)
            group.attr("transform", `translate(${d.cx + moveX}, ${d.cy + moveY})`);
        });
    });
    //--------------------- Create the following eyes on the page ---------------------//

    //--------------------- Load Data ---------------------//

    // Define data parser for "M/D/YY" format
    const parseTime = d3.timeParse("%m/%d/%y");

    // Load csv from folder
    d3.csv("https://raw.githubusercontent.com/lillar/d3xreact_course/refs/heads/main/data.csv").then(rawData => {
        const data = rawData.map(d => {
            return {
                date: parseTime(d.Date),
                value: +d["Move Minutes count"] || 0
            };
        }).filter(d => d.date !== null); // Ensure to skip invalid dates

        const weekData=Array.from(
            d3.rollup(data,v=>d3.sum(v,d=>d.value),d=>d3.timeWeek.floor(d.date)),
            ([date,value])=>({date,value})
            ).sort((a,b)=>a.date-b.date);
        
        data2020 = weekData.filter(d => d.date && d.date.getFullYear() === 2020);

        console.log("Formatted data sample: ", data.slice(0, 5));
        console.log("Rows for 2020:", data2020.length);

        // Set up sticky-viz
        const vizWidth = 800;
        const vizHeight = 600;

        // Set up inner dimensions
        const margin = {top: 20, right: 30, bottom: 40, left: 30};
        const width = vizWidth - margin.left - margin.right;
        const height = vizHeight - margin.top - margin.bottom;

        // Set up svg
    const svg = d3.select("#viz-canvas")
        .append("svg")
        // This defines the internal "zoom" box
        .attr("viewBox", `0 0 ${vizWidth} ${vizHeight}`)
        // This ensures it scales to fill the container
        .attr("width", "100%")
        .attr("height", "100%")
        // Keeps it centered if the aspect ratio differs
        .attr("preserveAspectRatio", "xMidYMid meet");

    const mainGroup = svg.append("g")
        .attr("transform", `translate(${margin.left}, ${margin.top})`);

        // Set up scales
        const x = d3.scaleTime()
            .domain([new Date(2020, 0, 1), new Date(2020, 11, 31)])
            .range([0, width]);

        const y = d3.scaleLinear()
            .domain([0, d3.max(weekData, d => d.value)])
            .range([height, 0]);

        // Set up area
        const area = d3. area()
            .x(d => x(d.date))
            .y0(y(0))
            .y1(d => y(d.value))
            .curve(d3.curveMonotoneX);

        // Draw area for 2020
        svg.append("path")
            .datum(data2020)
            .attr("class", "area-2020")
            .attr("fill", "#57A6A1")
            .attr("fill-opacity", 0.3)
            .attr("stroke", "#f1ede5")
            .attr("stroke-width", 0.2)
            .attr("d", area);

        // Add X Axis
        /*
        svg.append("g")
            .attr("class", "x-axis")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(x).ticks(d3.timeMonth.every(1)).tickFormat(d3.timeFormat("%b")))
            .attr("color", "#f1ede5")
            .attr("fill-opacity", 0.3);


        // Add Y Axis
        
        svg.append("g")
            .attr("class", "y-axis")
            .call(d3.axisLeft(y).ticks(5))
            .attr("color", "#f1ede5")
            .attr("fill-opacity", 0.3);
        */
    });

    //--------------------- Load Data ---------------------//
    
    
    //--------------------- Create D3 Scroll Logic ---------------------//

    // Function for transitions across steps
    function updateViz(step) {
        console.log("Entering step in story: ", step);

        if (step === "2020") {
            // Create d3 2020 area chart
        } else if (step === "2021") {
            // Create d3 2020-2021 area chart
        } else if (step === "yoy") {
            // Add YOY text in minutes and %
        } else if (step === "cumsum") {
            // Transform to cumsum line chart per year
        }
    }

    // Scroll trigger logic
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const step = entry.target.getAttribute('data-step');
                updateViz(step);
            }
        });
    }, {threshold: 0.5}); // Triggers when 50% of the text is visible

    document.querySelectorAll('.step').forEach(step => observer.observe(step));
    //--------------------- Create D3 Scroll Logic ---------------------//
    
</script>
    </body>
</html>